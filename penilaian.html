<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Form Penilaian</title>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<style>
    body {font-family: Arial, sans-serif; background: #ffffff; margin: 0;}
    header {background: #06b9a9; color: white; padding: 10px; text-align: center;}
    select, input, textarea {width: 95%; padding: 8px; margin: 5px 0; border: 1px solid #ccc; border-radius: 4px;}
    button {background: #06b9a9; color: white; border: none; padding: 10px; margin-top: 10px; border-radius: 4px; cursor: pointer;}
    button:hover {background: #049e92;}
    .container {padding: 10px;}
    table {width: 100%; border-collapse: collapse;}
    th, td {padding: 6px; border: 1px solid #ccc;}
    .visited {background-color: #d1f5f0;}
</style>
</head>
<body>

<header>
    Form Penilaian Lomba Kebersihan
</header>

<div class="container">
    <label>UNIT YANG DINILAI:</label>
    <select id="unit">
        <optgroup label="Radiologi">
            <option>MRI</option>
            <option>Rontgen</option>
            <option>CT Scan</option>
            <option>Panoramik</option>
        </optgroup>
        <optgroup label="RM (Rekam Medis)">
            <option>Tempat Arsip</option>
            <option>TPPRI</option>
            <option>Office</option>
        </optgroup>
        <optgroup label="Gizi">
            <option>Cook & Pastry</option>
            <option>Distribusi</option>
            <option>Gudang</option>
        </optgroup>
        <optgroup label="Lab (Laboratorium)">
            <option>PK</option>
            <option>PA</option>
        </optgroup>
        <optgroup label="Farmasi">
            <option>Ruang Resep / Apotek</option>
            <option>Rawat Inap</option>
            <option>Gudang</option>
            <option>IGD</option>
        </optgroup>
    </select>

    <table>
        <tr><th>NO</th><th>KRITERIA</th><th>NILAI (1â€“10)</th><th>CATATAN</th></tr>
        <tr><td>1</td><td>Ruangan bebas dari sampah</td><td><input type="number" min="1" max="10" id="n1"></td><td><input id="c1"></td></tr>
        <tr><td>2</td><td>Tempat sampah tersedia dan tidak berbau</td><td><input type="number" min="1" max="10" id="n2"></td><td><input id="c2"></td></tr>
        <tr><td>3</td><td>Tata ruang sesuai peruntukan</td><td><input type="number" min="1" max="10" id="n3"></td><td><input id="c3"></td></tr>
    </table>

    <label>Nama Penilai:</label>
    <input type="text" id="penilaiName">

    <button onclick="kirim()">Kirim Penilaian</button>

    <h3>Unit Sudah Dinilai</h3>
    <ul id="visited"></ul>
</div>

<script>
// Firebase Config (Ganti dengan punyamu)
var firebaseConfig = {
    apiKey: "AIzaSyCq-EXAMPLEKEY1234567890abcdefghi",
    authDomain: "lomba-kebersihan-rsmp.firebaseapp.com",
    databaseURL: "https://lomba-kebersihan-rsmp-default-rtdb.asia-southeast1.firebasedatabase.app/",
    projectId: "lomba-kebersihan-rsmp",
    storageBucket: "lomba-kebersihan-rsmp.appspot.com",
    messagingSenderId: "987654321000",
    appId: "1:987654321000:web:abcdef1234567890"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Cek login
if (!localStorage.getItem("role")) {
    window.location.href = "index.html";
}

// Tampilkan unit sudah dinilai
firebase.database().ref("penilaian").on("value", snap => {
    let visitedList = document.getElementById("visited");
    visitedList.innerHTML = "";
    snap.forEach(child => {
        if (child.val().penilai === localStorage.getItem("username")) {
            let li = document.createElement("li");
            li.textContent = child.val().unit;
            visitedList.appendChild(li);
        }
    });
});

function kirim() {
    let data = {
        unit: document.getElementById("unit").value,
        penilai: document.getElementById("penilaiName").value,
        nilai1: document.getElementById("n1").value,
        nilai2: document.getElementById("n2").value,
        nilai3: document.getElementById("n3").value,
        catatan1: document.getElementById("c1").value,
        catatan2: document.getElementById("c2").value,
        catatan3: document.getElementById("c3").value,
        token: "RSMP2025"
    };
    firebase.database().ref("penilaian").push(data, err => {
        if (err) alert("Gagal kirim: " + err);
        else alert("Penilaian terkirim!");
    });
}
</script>
</body>
</html>
