<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rekap Penilaian</title>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<style>
    body {font-family: Arial, sans-serif; background: #ffffff; margin: 0;}
    header {background: #06b9a9; color: white; padding: 10px; text-align: center;}
    table {width: 100%; border-collapse: collapse;}
    th, td {padding: 6px; border: 1px solid #ccc;}
    button {background: #06b9a9; color: white; border: none; padding: 8px 12px; margin: 10px; border-radius: 4px; cursor: pointer;}
    button:hover {background: #049e92;}
</style>
</head>
<body>
<header>
    Dashboard Rekap Penilaian
</header>
<button onclick="window.location.href='penilaian.html'">Ke Form Penilaian</button>
<table id="rekapTable">
    <tr><th>Unit</th><th>Penilai</th><th>Nilai 1</th><th>Nilai 2</th><th>Nilai 3</th><th>Catatan</th></tr>
</table>

<script>
// Firebase Config
var firebaseConfig = {
    apiKey: "AIzaSyCq-EXAMPLEKEY1234567890abcdefghi",
    authDomain: "lomba-kebersihan-rsmp.firebaseapp.com",
    databaseURL: "https://lomba-kebersihan-rsmp-default-rtdb.asia-southeast1.firebasedatabase.app/",
    projectId: "lomba-kebersihan-rsmp",
    storageBucket: "lomba-kebersihan-rsmp.appspot.com",
    messagingSenderId: "987654321000",
    appId: "1:987654321000:web:abcdef1234567890"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Cek login
if (localStorage.getItem("role") !== "admin") {
    window.location.href = "index.html";
}

// Ambil data
firebase.database().ref("penilaian").on("value", snap => {
    let table = document.getElementById("rekapTable");
    table.innerHTML = "<tr><th>Unit</th><th>Penilai</th><th>Nilai 1</th><th>Nilai 2</th><th>Nilai 3</th><th>Catatan</th></tr>";
    snap.forEach(child => {
        let v = child.val();
        let row = `<tr>
            <td>${v.unit}</td>
            <td>${v.penilai}</td>
            <td>${v.nilai1}</td>
            <td>${v.nilai2}</td>
            <td>${v.nilai3}</td>
            <td>${v.catatan1 || ""} ${v.catatan2 || ""} ${v.catatan3 || ""}</td>
        </tr>`;
        table.innerHTML += row;
    });
});
</script>
</body>
</html>
