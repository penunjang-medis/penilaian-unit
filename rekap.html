<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rekap Penilaian</title>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<style>
    body { font-family: Arial, sans-serif; background-color: #ffffff; margin:0; padding:0;}
    header { background-color: #06b9a9; color: white; padding: 15px; text-align: center; font-size: 20px;}
    table { width: 100%; border-collapse: collapse; margin-top: 15px;}
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left;}
    button { background-color: #06b9a9; color: white; padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer;}
</style>
</head>
<body>

<header>
    Rekap Penilaian Lomba Kebersihan
</header>

<div style="padding:15px;">
    <button onclick="window.location.href='penilaian.html'">Isi Form Penilaian</button>
    <table id="rekapTable">
        <thead>
            <tr>
                <th>Waktu</th>
                <th>Penilai</th>
                <th>Unit</th>
                <th>Nilai</th>
                <th>Catatan</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
if (localStorage.getItem("role") !== "admin") {
    window.location.href = "index.html";
}

var firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    databaseURL: "https://penilaian-penunjang-default-rtdb.asia-southeast1.firebasedatabase.app/",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
};
firebase.initializeApp(firebaseConfig);

firebase.database().ref("penilaian").on("value", snapshot => {
    let tbody = document.querySelector("#rekapTable tbody");
    tbody.innerHTML = "";
    snapshot.forEach(child => {
        let val = child.val();
        let row = `<tr>
            <td>${val.waktu}</td>
            <td>${val.penilai}</td>
            <td>${val.unit}</td>
            <td>${val.nilai ? val.nilai.join(", ") : ""}</td>
            <td>${val.catatan || ""}</td>
        </tr>`;
        tbody.innerHTML += row;
    });
});
</script>

</body>
</html>
